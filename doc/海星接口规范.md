### 1 海星接口规范*
#### 代码
##### 公用
>* 400  成功
>* 401  token过期，重新登入 
>* 402  该课程已发布
>* 403  手机号已注册
>* 405  密码错误
>* 406  数据库错误

### 用户场景
#### 1

##### 场景

>* 用户注册

##### 接口
```php
Param
    u_tel   //手机号
    u_pwd   //密码
    
Function register()
{
    //check u_tel
    if(u_tel存在)
    {
        return 403
    }
    
    insert table users_1
    
    create token
    
     if(数据库错误)
    {
        return 406
    }
    
    return 400
}
```

#### 2
##### 场景
>* 用户登入
##### 接口

```php
Param
    u_tel   //手机号
    u_pwd   //密码
    
Function login()
{
    //check token
    if(token过期)
    {
        return 401
    }
    
    //check u_pwd
    if(u_pwd不一致)
    {
        return 404
    }
    
    update token
     
    if(数据库错误)
    {
        return 406
    }
    
    return token
}
```


### 卖家场景
#### 1
##### 场景
>* 卖家创建发布课程
##### 接口

```php
Param
    token      //token
    
    c_name   //课程名称
    c_intro  //课程介绍
    c_major  //课程专业
    c_detail //课程详情
    c_img    //课程封面jpg or png
    c_price  //课程价格
    c_len    //课程时长
    c_time   //课程时间
    c_place  //课程地点

Function cou_release()
{
    //check token
    if(token过期)
    {
        return 401
    }
    
    update token
    
    通过token返回u_id
    
    /*
    *insert courses_1、courses_2
    *先通过u_id搜索到该用户全部课程
    *再对比，会比较快
    *
    */
    if(c_intro,c_major,c_name，c_detail与数据库中的不同)
    {
        insert into courses_1 courses_2 where u_id = u_id
    }else
    {
        return 402
    }
    
    
    if(数据库错误)
    {
        return 406
    }
    
    return 400 
}
```
#### 2
##### 场景
>* 卖家界面_审核中课程列表
##### 接口

```php
Param
    token
Function cou_check()
{
    //check token
    if(token过期)
    {
        return 401
    }
    
    update token
    
    select u_id from sys_token where token = token
    
    select c_name,c_imgpath,c_price,c_time,c_state,c_id from courses_1、course_2 where 
    courses_1.c_releaseid = u_id and
    courses_2.c_state = 0 
    
    if(数据库错误)
    {
        406
    }
    
    return c_name,c_imgpath,c_price,c_time,c_state,c_id
}
```
#### 3
##### 场景
>* 卖家界面_上架中课程列表
##### 接口

```php
Param
    token
Function cou_grounding()
{
    //check token
    if(token过期)
    {
        return 401
    }
    
    update token
    
    select u_id from sys_token where token = token
    
    select c_name,c_imgpath,c_price,c_time,c_state,c_id from courses_1、course_2 where 
    courses_1.c_releaseid = u_id and
    courses_2.c_state = 1 or 2
    
    if(数据库错误)
    {
        406
    }
    
    return c_name,c_imgpath,c_price,c_time,c_state,c_id
}
```

#### 4
##### 场景
>* 卖家界面_已下架课程列表
##### 接口

```php
Param
    token
Function cou_undercarriage()
{
    //check token
    if(token过期)
    {
        return 401
    }
    
    update token
    
    select u_id from sys_token where token = token
    
    select c_name,c_imgpath,c_price,c_time,c_state,c_id from courses_1、course_2 where 
    courses_1.c_releaseid = u_id and
    courses_2.c_state = 3
    
    if(数据库错误)
    {
        406
    }
    
    return c_name,c_imgpath,c_price,c_time,c_state,c_id
}
```

#### 5
##### 场景
>* 卖家界面-点击进入该课程

##### 接口

```php
Param
    token    //token
    c_id     //课程ID
Funtion cou_entercou()
{
    //wait for UI
}
```

#### 6
##### 场景
>* 卖家界面-编辑课程

##### 接口

```php
Param
    token    //token
    c_id     //课程ID
Function cou_editcou()
{
    //wait for UI
}
```

### 买家场景
#### 1
##### 场景
>* 买家将课程加入购物车
##### 接口

```php
Param
    token       //token
    
    c_id     //课程ID
    c_num    //购买数量
Function cou_shopping()
{
    //check token
    if(token过期)
    {
        return 401
    }
    
    update token
    
    通过token返回u_id
    
    insert into shopping_carts
    
    if(数据库错误)
    {
        return 406
    }
    return 400
}

```
#### 2
##### 场景
>* 买家购物车列表
##### 接口

```php
Param
    token   //token
Function get_carts()
{
    //check token
    if(token过期)
    {
        return 401
    }
    
    update token
    
    通过token返回u_id
    
    //通过u_id搜索用户全部订单
    select sp_id,shopping_carts.c_id,c_num,c_name,c_price,c_imgpath
    from shopping_carts，courses_1,courses_2
    where shopping_carts.c_id = courses_1.c_id,shopping_carts.c_id = courses_1.c_id,
    shopping_carts.u_id = u_id
    
    if(数据库错误)
    {
        return 406
    }
    /*
    *返回用户购物车内容
    */
    return sp_id,shopping_carts.c_id,c_num,c_name,c_price,c_imgpath 
}
```
#### 3
##### 场景
>* 买家购物车列表-点击进入某个课程

##### 接口
```php
Param 
    token         //token
    sp_id          //课程ID
Function entercou()
{
    //check token
    if(token过期)
    {
        return 401
    }
    
    update token
    
    //通过c_id搜索课程全部信息，并返回
    select * from courses_1,courses_2 where c_id = courses_1.c_id,c_id = courses_2
    
     if(数据库错误)
    {
        return 406
    }
    
    return all data
}
```
#### 4
##### 场景
>* 移除单个购物车
##### 接口

```php
Param
    token
    sp_id
Function move_cart()
{
    //check token
    if(token过期)
    {
        return 401
    }
    
    update token
    
    delete from shopping_cart where sp_id = sp_id
    
    if(数据库错误)
    {
        return 406
    }
    
    return 400
}
```
#### 5
##### 场景
>* 批量移除购物车
##### 接口

```php
Param
    token
    sp_id[]
Function move_carts()
{
    //check token
    if(token过期)
    {
        return 401
    }
    
    update token
    
    delete from shopping_cart where sp_id[] = sp_id[]
    
    if(数据库错误)
    {
       return 406
    }
    
    return 400
}
```

#### 6
##### 场景
>* 买家下订单(未付款)
##### 接口

```php
Param
    token
    c_id                //课程ID
    order_money        //课程总金额
Function cou_order()
{
    //check token
    if(token过期)
    {
        return 401
    }
    
    update token
    //添加进订单
    insert into orders
    //将课程设为已购买状态
    update course_2 set c_state = 2 where c_id = c_id
    
    if(数据库错误)
    {
       return 406
    }
    
    return 400
}
```

#### 7
##### 场景
>* 买家订单列表
##### 接口

```php
Param
    token   //token
Function cou_orderlist()
{
    //check token
    if(token过期)
    {
        return 401
    }
    
    update token
    
   select order_id,order_time,order_money,order_state,u_tel,u_name,c_id,
   c_name,c_imgpath,c_price,c_num from courses_1,courses_2,
   orders
    
    if(数据库错误)
    {
       return 406
    }
    
   return order_id,order_time,order_money,order_state,u_tel,u_name,c_id,
   c_name,c_imgpath,c_price,c_num
}
```

#### 7
##### 场景
>* 取消订单
##### 接口

```php
Param
    token
    order_id      //订单号
Function cou_cancelorder()
{
    //check token
    if(token过期)
    {
        return 401
    }
    
    update token
    
   //wait for UI
}
```
### 系统场景
#### 1
##### 场景
>* 系统审核
##### 接口

```php
Param
    
Function cou_check()
{
   //wait for UI
    
}
```

